---
import Layout from "../layouts/Layout.astro";
import { fetchPageBlocks } from "../lib/directus";
import type { Page } from "../types/directus";
import BlocksToComponents from "../components/BlocksToComponents.astro";

export const prerender = false;

const slug = Astro.params.slug as string;

const page = (await fetchPageBlocks(slug)) as Page | null;

if (!page) {
  return new Response(null, { status: 404 });
}

const pageData = page as Page;
const { blocks } = pageData;
---

<Layout seo={pageData.seo}>
  <BlocksToComponents blocks={blocks} slug={slug} pageTitle={pageData.title} />
</Layout>
